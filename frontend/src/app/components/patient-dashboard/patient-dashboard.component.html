<div class="dashboard-container">
  <div class="patient-info-sidebar">
    <div class="user-info">
      <h2>Welcome, {{profile?.name || 'Patient'}}</h2>
      <p class="email">{{profile?.email}}</p>
      <p class="phone">Phone: {{profile?.phone}}</p>
      <button class="logout-btn" (click)="logout()">Logout</button>
    </div>
    <div class="actions">
      <button class="book-btn" (click)="navigateToBookAppointment()">Book New Appointment</button>
    </div>
  </div>

  <div class="appointments-section">
    <h3>Your Appointments</h3>

    <div class="filters">
      <div class="filter-group">
        <select [(ngModel)]="statusFilter">
          <option value="all">All Status</option>
          <option value="scheduled">Scheduled</option>
          <option value="canceled">Canceled</option>
        </select>

        <select [(ngModel)]="sortOrder">
          <option value="new">Newest First</option>
          <option value="old">Oldest First</option>
        </select>

        <select [(ngModel)]="specializationFilter">
          <option value="all">All Specializations</option>
          <option *ngFor="let spec of specializations" [value]="spec">
            {{spec}}
          </option>
        </select>

        <select [(ngModel)]="doctorFilter">
          <option value="all">All Doctors</option>
          <option *ngFor="let doc of appointmentDoctors" [value]="doc">
            {{doc}}
          </option>
        </select>

        <button class="reset-btn" (click)="resetFilters()">Reset</button>
      </div>
    </div>

    <div *ngIf="loading" class="loading">Loading appointments...</div>
    <div *ngIf="error" class="error">{{error}}</div>
    <div class="appointment-list" *ngIf="!loading && !error">
      <div *ngFor="let appointment of filteredAppointments" class="appointment-card">
        <div class="appointment-header">
          <div class="appointment-time">
            <div class="date">{{appointment.appointment_time | date:'fullDate'}}</div>
            <div class="time">{{appointment.appointment_time | date:'shortTime'}}</div>
          </div>
          <span class="status" [class.status-scheduled]="appointment.status === 'scheduled'">
            {{appointment.status}}
          </span>
        </div>

        <div class="appointment-details" *ngIf="appointment.doctor">
          <div class="doctor-info">
            <div class="doctor-name">{{appointment.doctor.name}}</div>
            <div class="doctor-specialization">{{appointment.doctor.specialization || 'General Practice'}}</div>
          </div>
          <div class="contact-info">
            <div class="contact-item">
              <span class="icon">ðŸ“§</span>
              <span class="text">{{appointment.doctor.email}}</span>
            </div>
            <div class="contact-item">
              <span class="icon">ðŸ“ž</span>
              <span class="text">{{appointment.doctor.phone}}</span>
            </div>
          </div>
        </div>

        <div class="appointment-actions" *ngIf="appointment.status === 'scheduled'">
          <button class="update-btn" (click)="updateAppointment(appointment)">
            Update Appointment
          </button>
          <button class="cancel-btn" (click)="cancelAppointment(appointment.id)">
            Cancel Appointment
          </button>
        </div>
      </div>
      <p *ngIf="!filteredAppointments.length" class="no-appointments">No appointments found.</p>
    </div>
  </div>

  <div class="doctors-sidebar">
    <h3>Available Doctors</h3>
    <div class="doctors-list">
      <div *ngFor="let doctor of doctors" class="doctor-card">
        <div class="doctor-info">
          <div class="doctor-name">{{doctor.name}}</div>
          <div class="doctor-specialization">{{doctor.specialization || 'General Practice'}}</div>
        </div>
        <button class="book-btn" (click)="bookWithDoctor(doctor)">Book</button>
      </div>
    </div>
  </div>
</div>